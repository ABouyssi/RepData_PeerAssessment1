{
    "contents" : "unzip(zipfile = \".\\\\activity.zip\")\nactivity = read.csv(file = \".\\\\activity.csv\", header = TRUE)\n\nlibrary(dplyr)\nactivity = tbl_df(activity)\n\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\nto_plot = as.data.frame(x = activity %>%\n    group_by(date) %>%\n    summarize(sum_steps = sum(x = steps, na.rm = TRUE)) %>%\n    select(date, sum_steps))\n\np = ggplot(data = to_plot, aes(x = sum_steps))\np = p + geom_histogram(binwidth = 1000, fill = \"blue\")\np = p + labs(title = \"Distribution of daily number of steps\")\np = p + labs(x = \"Total daily number of steps (bins of 1,000 steps)\")\np = p + labs(y = \"Frequency (number of days)\")\np\n\nactivity %>%\n  group_by(date) %>%\n  summarize(sum_steps = sum(x = steps, na.rm = TRUE)) %>%\n  summarize(avg_steps = mean(x = sum_steps)) %>%\n  select(avg_steps)\n\nto_plot = as.data.frame(x = activity %>%\n  group_by(interval) %>%\n  summarize(avg_steps = mean(x = steps, na.rm = TRUE)) %>%\n  select(interval, avg_steps))\n\np = ggplot(data = to_plot, aes(x = interval, y = avg_steps))\np = p + geom_line(color = \"red\")\np = p + labs(title = \"Average daily profile of number of steps\")\np = p + labs(x = \"1 day (segmented in 5 minute invervals)\")\np = p + labs(y = \"Average number of steps\")\np\n\nx = to_plot[to_plot$avg_steps == max(to_plot$avg_steps), 1]*60\nSys.setlocale(category = \"LC_TIME\", locale = \"US\") \nformat(as.POSIXct('0001-01-01 00:00:00') + x, \"%I:%M:%S %p\") \n\nactivity %>%\n  summarize(missing_values = sum(is.na(steps))) %>%\n  select(missing_values)\n\nactivity %>%\n  filter(is.na(steps) == TRUE) %>%\n  inner_join(to_plot, by = c(\"interval\")) %>%\n  select(avg_steps)\n\nactivity_missing = activity %>%\n  select(steps, date, interval) %>%\n  filter(is.na(steps) == TRUE) %>%\n  inner_join(to_plot, by = c(\"interval\")) %>%\n  mutate(steps_imputed = round(avg_steps,0)) %>%\n  select(date, interval, steps_imputed)\n\nactivity_present = activity %>%\n  select(steps, date, interval) %>%\n  filter(is.na(steps) == FALSE) %>%\n  mutate(steps_imputed = steps) %>%\n  select(date, interval, steps_imputed)\n\nactivity_imputed = bind_rows(activity_missing, activity_present) %>%\n  arrange(date, interval)\n\ninner_join(activity, to_plot, by = c(\"interval\"))\n\nnum_days = as.numeric(activity %>%\n  distinct(date) %>%\n  summarize(num_days = n()) %>%\n  select(num_days))\n\ndaily_profile = data.frame()\nfor (i in 1:num_days){\n  daily_profile = rbind(daily_profile,to_plot)\n}\n\nactivity_imputed = activity\nattach(activity_imputed)\nsteps[is.na(steps)] = daily_profile[is.na(steps),2]\n\n\nactivity$steps_imputed = activity$steps\nfor (i in 1:nrow(activity)){\n  attach(activity)\n  if(is.na(steps[i])){\n    steps_imputed[i] = daily_profile[interval[i],2]\n  }\n}\n\n\nactivity$steps[is.na(steps)] = 0\n\nactivity_imputed = activity %>%\n  mutate(missing_values = is.na(steps) * 1) %>%\n  mutate(steps_imputed = missing_values * daily_profile[interval, 2]) %>% \n  #mutate(steps_num = (steps[is.na(steps)] = 0))\n  mutate(steps_final = steps_imputed + steps_num)\n\n\nto_plot = as.data.frame(x = activity_imputed %>%\n          group_by(date) %>%\n          summarize(sum_steps = sum(x = steps_imputed)) %>%\n          select(date, sum_steps))\n\n\nday_type = function(d){\n  if(weekdays(x = as.Date(d)) %in% c(\"Saturday\", \"Sunday\")) {\n    as.factor(\"Weekend\")\n  } else{as.factor(\"Weekday\")}\n}\n\nto_plot = activity_imputed %>%\n  mutate(day_type = sapply(X = date, FUN = day_type)) %>%\n  group_by(day_type, interval) %>%\n  summarize(avg_steps = mean(steps_imputed)) %>%\n  select(day_type, interval, avg_steps)\n\np = ggplot(data = to_plot, aes(x = interval, y = avg_steps))\np = p + geom_line(color = \"purple\")\np = p + facet_grid(day_type ~ .)\np = p + labs(title = \"Average daily profile of number of steps\")\np = p + labs(x = \"1 day (segmented in 5 minute invervals)\")\np = p + labs(y = \"Average number of steps\")\np",
    "created" : 1434190362447.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3336559804",
    "id" : "122B190D",
    "lastKnownWriteTime" : 1434276661,
    "path" : "C:/Users/Adrien Bouyssi/Desktop/Courses/Reproducible research/Peer_Assessment/RepData_PeerAssessment1/debugging.R",
    "project_path" : "debugging.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "source_on_save" : false,
    "type" : "r_source"
}